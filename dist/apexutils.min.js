const menuTemplate=`<div class="PrUnTools_Menu_Wrap" id="PrUnTools_Menu"></div>`;const menuItemTemplate=`<div class="PrUnTools_Menu_Item {{:class}}" title="{{:tooltip}}">
            <span class="PrUnTools_Menu_Item_Label" id="{{:id}}">{{:text}}</span>
            <div class="PrUnTools_Menu_Item_Indicator"></div>
        </div>`;const bufferTemplate=`<div class="PrUnTools_TileFrame">
            <div class="PrUnTools_TileFrame_Header">
                <div class="PrUnTools_TileFrame_Title">{{:title}}</div>
                <div class="PrUnTools_TileFrame_SubTitle">{{:subtitle}}</div>
            </div>
            <div class="PrUnTools_TileFrame_Body">
                <div class="PrUnTools_TileFrame_Anchor">
                    <div style="position: relative; overflow: hidden; width: 100%; height: 100%;">
                        <div style="position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px; overflow: scroll; margin-right: -17px; margin-bottom: -17px;">
                            {{:content}}
                        </div>
                    </div>
                </div>
            </div>
        </div>`;const alertTemplate=`
        <div class="PrUnTools_Alert_Overlay alert-{{:color}}">
            <div class="PrUnTools_Alert_Content">
                <span class="PrUnTools_Alert_Title">
                    <span>{{:alert_title}}</span>
                </span>
                <span class="PrUnTools_Alert_Content">
                    <div>
                        <span>{{:alert_message}}</span>
                    </div>
                </span>
            </div>
        </div>
    `;const logoElement='._2fyRVq2wB-JiJ3M4q1mEB';class ApexUtils{#isLoaded;#logoObserver;constructor(){if(this.screenChangeDelay==null){this.screenChangeDelay=750}}
    load(additionalStyles='',menuTimeout=5000){if(additionalStyles!=''){$('HEAD').append($('<STYLE>').html(additionalStyles))}
        if(!$('BODY').hasClass('PrUnTools')){$('BODY').addClass('PrUnTools');$('HEAD').append($('<LINK>').attr('href','https://timthedevguy.com/apexutils/apexutils_styles.min.css').attr('rel','stylesheet'));this.#monitorOnLoaded()}}
    get screenChangeDelay(){return localStorage.getItem('screenChangeDelay')}
    set screenChangeDelay(delayInMilliseconds){localStorage.setItem('screenChangeDelay',delayInMilliseconds)}
    get isLoaded(){return this.#isLoaded}
    set isLoaded(loaded){this.#isLoaded=loaded}
    get state(){return document.getElementById('container')._reactRootContainer._internalRoot.current.child.child.child.pendingProps.store.getState().toJS()}
    addMenuItem(id,text,tooltip='',handler,cssClass='',disable=!1,menuId='#PrUnTools_Menu'){if(disable){cssClass+='PrUnTools_Disabled'}
        let menuHtml=menuItemTemplate.replace('{{:id}}',id).replace('{{:text}}',text).replace('{{:tooltip}}',tooltip).replace('{{:class}}',cssClass);let menuItem=$(menuHtml);$(menuId).append($(menuItem));if(handler!==undefined){$(menuItem).click(handler)}}
    flashMenuItem(id,color,timeout=1000){return new Promise(function(fulfill,reject){let indicator=$('#'+id).parent().children("DIV.PrUnTools_Menu_Item_Indicator")
        let classes=indicator.attr('class').split(/\s+/);classes.forEach((item)=>{if(item!='PrUnTools_Menu_Item_Indicator'){indicator.removeClass(item)}});indicator.addClass('rapid-pulse').addClass(color);setTimeout(function(){indicator.removeClass('rapid-pulse').removeClass(color);classes.forEach((item)=>{if(item!='PrUnTools_Menu_Item_Indicator'){indicator.addClass(item)}});fulfill()},timeout)})}
    setMenuItemColor(id,color){let indicator=$('#'+id).parent().children("DIV.PrUnTools_Menu_Item_Indicator")
        $(indicator).attr('class','PrUnTools_Menu_Item_Indicator');indicator.addClass(color)}
    showBuffer(title,subtitle,width,height,content){$('[class="_38GFUZ_bqqfSehlTdlvwGE _2tgF3CjTxcwKdSpZ_motdg _33A_5lETf4HBqwJi_q-jhZ _1vWRpdI8cKNMPyOPnzlXgX"]').click();let buffer=$('DIV[class="_1Gt2vj54dwdsGZMO13RxjN"]:not(".PrUnTools_taken") DIV[class="_86iI4sy8I8Gb9DRZloqFB"]:first').parent().parent().parent().addClass('PrUnTools_taken');$(buffer).find('DIV[class="_86iI4sy8I8Gb9DRZloqFB"]').remove();$(buffer).find('DIV[class="_1mubANzqV2fICrNGnMze0y"]').remove();$(buffer).find('SPAN[class="_3pd4GjlRDJtIK4izuUrc2Q BNTJu1og0XIu3K26V_ddU _33A_5lETf4HBqwJi_q-jhZ _2_LtsZLiGIKxWd_UHEKnY6"]').remove();let bufferFrame=bufferTemplate.replace('{{:title}}',title).replace('{{:subtitle}}',subtitle).replace('{{:content}}',content);$(buffer).find('DIV[class="_1T3GrusQ2ydTsNKeMaEfPl"]').attr('style','position: relative; user-select: auto; width: '+width+'px; height: '+height+'px; box-sizing: border-box;')
        $(buffer).find('DIV[class="_2-M8WlI-JS7ws_xSL-0yYo"]').append($(bufferFrame))}
    showAlertBuffer(frame_title,frame_subtitle,alert_title,alert_message,width,height,color='yellow'){$('[class="_38GFUZ_bqqfSehlTdlvwGE _2tgF3CjTxcwKdSpZ_motdg _33A_5lETf4HBqwJi_q-jhZ _1vWRpdI8cKNMPyOPnzlXgX"]').click();let buffer=$('DIV[class="_1Gt2vj54dwdsGZMO13RxjN"]:not(".PrUnTools_taken") DIV[class="_86iI4sy8I8Gb9DRZloqFB"]:first').parent().parent().parent().addClass('PrUnTools_taken');$(buffer).find('DIV[class="_86iI4sy8I8Gb9DRZloqFB"]').remove();$(buffer).find('DIV[class="_1mubANzqV2fICrNGnMze0y"]').remove();$(buffer).find('SPAN[class="_3pd4GjlRDJtIK4izuUrc2Q BNTJu1og0XIu3K26V_ddU _33A_5lETf4HBqwJi_q-jhZ _2_LtsZLiGIKxWd_UHEKnY6"]').remove();let alertBox=alertTemplate.replace('{{:alert_title}}',alert_title).replace('{{:alert_message}}',alert_message).replace('{{:color}}',color);let bufferFrame=bufferTemplate.replace('{{:title}}',frame_title).replace('{{:subtitle}}',frame_subtitle).replace('{{:content}}',alertBox);$(buffer).find('DIV[class="_1T3GrusQ2ydTsNKeMaEfPl"]').attr('style','position: relative; user-select: auto; width: '+width+'px; height: '+height+'px; box-sizing: border-box;')
        $(buffer).find('DIV[class^="_2-M8WlI-JS7ws_xSL-0yYo"]').append($(bufferFrame))}
    completeLoad(){this.#monitorOnScreenChange();this.#monitorOnTileUpdate();this.#monitorOnBufferCreated()}
    help(){return `<div style="padding: 0 20px;">
                <h2>Welcome to ApexUtils</h2>
                <h3>What is ApexUtils</h3>
                <p>PrUnTools started as a private set of tools that I wrote with another member of the community. I then 
                noticed that I could seperate the Apex code in to it's own reusable library which resulted in ApexUtils.  This would allow me to keep
                 my tools and provide a framework for others to use to create their own.</p>
                <p>ApexUtils is a set of utility functions designed to be used by TamperMonkey scripts (or similar products) 
                 to interact with the APEX interface in a safe way.  The utility also loads CSS that mimics the style of
                  APEX but with class names you can use in your own HTML.</p>
                <h3>What ApexUtils is NOT</h3>
                <p>ApexUtils is NOT a framework for creating Bots.  It performs only one automatic click to create a 
                new buffer window.  I have personally showed this feature to the Devs and they are ok with it.  <strong>You</strong> are
                 responsible for what  you create with the tool.</p>
                <h3>Is this against ToS</h3>
                <p>No. ApexUtils itself only reads and adds content to the Client.  It does not send data to the server or
                automate client tasks.  ApexUtils interfaces with the DOM elements of the page and does not attempt to 
                interact with the Javascript in the page, all modifications are done using it's own Javascript utilizing 
                jQuery.</p>
                <h3>What can I use ApexUtils for</h3>
                <p>ApexUtils can be used to make anything that would be useful on the client.  For example the included FMAP 
                utility used to show the Flat Map of the universe.</p>
                <h3>Resources</h3>
                <ul>
                    <li>GitHub</li>
                </ul>
            </div>`}
    #monitorOnBufferCreated(){let containerSelector='body';let elementSelector='._1T3GrusQ2ydTsNKeMaEfPl';let onMutationsObserved=function(mutations){mutations.forEach(function(mutation){if(mutation.addedNodes.length){var elements=$(mutation.addedNodes).find(elementSelector);for(var i=0,len=elements.length;i<len;i++){document.dispatchEvent(new Event('PrUnTools_BufferCreated'))}}})};let target=$(containerSelector)[0];let config={childList:!0,subtree:!0};let MutationObserver=window.MutationObserver||window.WebKitMutationObserver;let observer=new MutationObserver(onMutationsObserved);observer.observe(target,config)}
    #monitorOnScreenChange(){let elementSelector='._24lAeqvUD4WLUdWUGCWeky';let onMutationsObserved=function(mutations){document.dispatchEvent(new Event('PrUnTools_ScreenChange_Started'));if(!$($(logoElement)[0]).hasClass('_9loCuZeuQgJye2371syub')){document.dispatchEvent(new Event('PrUnTools_ScreenChange_Complete'))}else{setTimeout(onMutationsObserved,300)}};let target=$(elementSelector)[0];let config={characterData:!0,attributes:!1,childList:!1,subtree:!0};let MutationObserver=window.MutationObserver||window.WebKitMutationObserver;let observer=new MutationObserver(onMutationsObserved);observer.observe(target,config)}
    #monitorOnTileUpdate(){let containerSelector='.OJocR3KT1lbvOOS1r8bq8';let elementSelector='._1h7jHHAYnTmdWfZvSkS4bo';let onMutationsObserved=function(mutations){if(!$($(logoElement)[0]).hasClass('_9loCuZeuQgJye2371syub')){document.dispatchEvent(new Event('PrUnTools_TileUpdate'))}else{setTimeout(onMutationsObserved,300)}};let target=$(containerSelector)[0];let config={childList:!0,subtree:!0};let MutationObserver=window.MutationObserver||window.WebKitMutationObserver;let observer=new MutationObserver(onMutationsObserved);observer.observe(target,config)}
    #monitorOnLoaded(){let onMutationsObserved=function(mutations){if(!$($(logoElement)[0]).hasClass('_9loCuZeuQgJye2371syub')){if(!apex.isLoaded){apex.isLoaded=!0;apex.disconnect('logoObserver');$('[class="_1M1EcDYyJhRT-bBiQgj4Zw"] DIV[class="vRC84tCrVmNxLdPLazT0o"]:last').after($(menuTemplate));apex.completeLoad();document.dispatchEvent(new Event('PrUnTools_Loaded'))}}};let target=$(logoElement)[0];let config={characterData:!1,attributes:!0,childList:!1,subtree:!1,attributeFilter:['class']};let MutationObserver=window.MutationObserver||window.WebKitMutationObserver;this.#logoObserver=new MutationObserver(onMutationsObserved);this.#logoObserver.observe(target,config)}
    disconnect(observerName){if(observerName==='logoObserver'){this.#logoObserver.disconnect()}}}
const apex=new ApexUtils();Object.freeze(apex)